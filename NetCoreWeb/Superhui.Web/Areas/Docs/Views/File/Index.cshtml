@model String

<div>
  <textarea style="display:none" id="mark-content">@Model</textarea>
</div>

@section Catalog{
  @foreach (var f in (Newtonsoft.Json.Linq.JArray)ViewBag.Catalogue) {
    <li>
      <!-- <a hrefs=@string.Format("/docs{0}", @f["path"]) onclick="refresh(this)">@f["name"]</a> -->
      <a hrefs=@string.Format("{0}", @f["path"]) onclick="refresh(this)">@f["name"]</a>

    </li>
  }
}

@section Links{
  <link rel="stylesheet" href="~/css/mark.css" />
}

@section Scripts{
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script>
    $(document).ready(function(){
      document.getElementById('blog-content').innerHTML =
      marked($("#mark-content").val());
    });

    <!-- xhr -->
    var xhr = new XMLHttpRequest();
    xhr.open('GET', "/api/file/fileInfo/note/racs");
    xhr.responseType = 'json';
    xhr.onload = function() {
      console.log(xhr.response);
    };
    xhr.onerror = function() {
      console.log("Oops, error");
    };
    xhr.send();

    <!-- fetch -->
    fetch("/api/file/fileInfo/note/racs").then(function(response) {
      return response.json();
    }).then(function(data) {
      console.log(data);
      for(const blink of data.children) {
        console.log(blink)
        $("#catalog").append(`<li><a href="/docs${blink.path}">${blink.name}</a></li>`);
      }
    }).catch(function(e) {
      console.log("Oops, error");
    });

    fetch("/api/file/content/note/linux/config.md").then(function(response) {
      return response.text();
    }).then(function(data) {
      console.log(data);
      document.getElementById('blog-content').innerHTML =
      marked(data);
    }).catch(function(e) {
      console.log("Oops, error");
    });

    function refresh (url) {
      console.log($(url).attr('hrefs'))
      const uri = $(url).attr('hrefs')
      fetch("/api/file/content" + uri).then(function(response) {
        return response.text();
      }).then(function(data) {
        console.log(data);
        document.getElementById('blog-content').innerHTML =
        marked(data);
      }).catch(function(e) {
        console.log("Oops, error");
      });
    }
  </script>
}

